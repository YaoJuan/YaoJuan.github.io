<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"qingheblog.online","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":40,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言 2季度我主要的任务也是做一个首页的重构，伴随着2季度的结束，也终于有时间来对这个方面来做一个总结  现存的问题  * 字典软编码 大量后台数据回来不做本地解析，直接用字典进行操作。 这样做首先编译器没有任何提示，拥有敲错的隐患，而且开发效率不高。 另外在字典写以及传值中经常会变成可变字典。导致多个环境中本来应该共享的数据其实并不是同一份。而解析成本地的对象直接对对象进行操作可以很好的弥补这一">
<meta property="og:type" content="article">
<meta property="og:title" content="首页重构">
<meta property="og:url" content="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/index.html">
<meta property="og:site_name" content="遇见青禾">
<meta property="og:description" content="前言 2季度我主要的任务也是做一个首页的重构，伴随着2季度的结束，也终于有时间来对这个方面来做一个总结  现存的问题  * 字典软编码 大量后台数据回来不做本地解析，直接用字典进行操作。 这样做首先编译器没有任何提示，拥有敲错的隐患，而且开发效率不高。 另外在字典写以及传值中经常会变成可变字典。导致多个环境中本来应该共享的数据其实并不是同一份。而解析成本地的对象直接对对象进行操作可以很好的弥补这一">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%841.png">
<meta property="og:image" content="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%842.png">
<meta property="og:image" content="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%843.png">
<meta property="article:published_time" content="2021-07-05T02:20:00.000Z">
<meta property="article:modified_time" content="2021-07-05T07:12:13.124Z">
<meta property="article:author" content="青禾">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%841.png">

<link rel="canonical" href="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>首页重构 | 遇见青禾</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">遇见青禾</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">qingheblog.online</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">8</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">28</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="青禾">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="遇见青禾">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          首页重构
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-07-05 10:20:00 / 修改时间：15:12:13" itemprop="dateCreated datePublished" datetime="2021-07-05T10:20:00+08:00">2021-07-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">工作总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>2季度我主要的任务也是做一个首页的重构，伴随着2季度的结束，也终于有时间来对这个方面来做一个总结</p>
<h4 id="现存的问题"><a href="#现存的问题" class="headerlink" title="现存的问题"></a>现存的问题</h4><ul>
<li><strong><em>字典软编码</em></strong>  大量后台数据回来不做本地解析，直接用字典进行操作。 这样做首先编译器没有任何提示，拥有敲错的隐患，而且开发效率不高。 另外在字典写以及传值中经常会变成可变字典。导致多个环境中本来应该共享的数据其实并不是同一份。而解析成本地的对象直接对对象进行操作可以很好的弥补这一点</li>
<li><strong><em>没有任何代码架构</em></strong>   由于首页已经迭代了5年，每个开发的水平又不一样。所以各种所谓的MVC和MVVM混用，导致难以迭代</li>
<li><strong><em>没有任何的业务分层</em></strong>   由于电商业务迭代的快速性。之前所有的开发都是在屎山上进行迭代，后果就是让屎山变得更屎，以至于现在出了问题及其难查。所有的业务都是为了快速交付。业务代码全部杂糅在一起，光首页控制器中就有2w+行代码</li>
<li><strong><em>性能低下</em></strong>   早期整个视图用的是tableview，导致之后做一些瀑布流的操作只能用各种视图嵌套的方式来完成，导致性能低下，冗余代码过多</li>
<li><strong><em>太多数据处理在客户端</em></strong>  由于之前客户端的同事在和其他部门pk的时候过于不够强势，所以大量的数据处理都在客户端。让客户端拿到的数据基本不可直接使用，要多个接口进行拼接，筛选，甚至排序才能使用，进一步导致了</li>
<li><strong><em>完全无法多人开发</em></strong>。由于上述这些特性，导致完全只能由熟悉首页的同事开发，而我们需求主要迭代都是关于首页。直接导致了“1核开发，多核围观”</li>
</ul>
<h4 id="想达到的效果"><a href="#想达到的效果" class="headerlink" title="想达到的效果"></a>想达到的效果</h4><ul>
<li><strong><em>视图的升级</em></strong>  作为tableview的升级版collectionview，可以完美完成tab的诉求，并且可以做很多tab做不到的事情。另外首页中还有大量的其他的小视图没有做好层级分类。例如多个子视图都应该做为一个父视图交付给首页，而被写成了每个子视图都提供了对应的interface给外界进行了访问。应该对这种类型的视图进行收束，让首页的构成变成简单的一个collectionview+ 若干个大视图的方式。大视图管理自己的子视图，提供统一的接口给首页访问</li>
<li><strong><em>数据层的处理</em></strong>  客户端需要的数据必须更加纯粹，相对于代码的架构来说。部门的架构同样重要，任务分工是很有必要的。将一些数据处理的逻辑放在后台可以直接让客户端、h5端3端的工作量大大减小。整体的代码也清晰明了</li>
<li><strong><em>复杂且多样的cell的处理</em></strong>  对于collectionview来说，装载的肯定是各种各样的cell，但是我们以往的写法都是判断数据的类型，然后拿到不同的reuseidentifier,然后进行生成cell。或者拿到不同的itemsize，这样重复的代码在大量的代理和数据源的方法中再来n次。其实既然数据是从后台来的，每个后台回来的model肯定有数据来标识不同类型的展示方式，然后每个cell都需要itemsize以及重用标识符等等共同字段。其实可以利用面向对象的方式进行一层封装。控制器的数据源数组种装载的就是这些一层层封装的数据。对于需要用到的时候从数组中可以利用逆变的思想。因为对于数据源和代理来说，父类的这些数据使用。然后对于所有的cell抽一个公共的父类，提供一个接受转换过的数据来丰富自己内容的方法。在经过上面数据重用来的cell我们还是可以通过逆变来看待成统一的父类的cell，然后用上面说过的填充的方法去丰富他自身。这个时候就会利用到多态的真实类型，在每个实际类型的cell中来进行这个丰富自身的实现</li>
<li><strong><em>面向模型的开发</em></strong>  所有的页面的各个模块是否展示，展示成什么样都由对应的数据模型模块来决定。view只是这个数据的一种展现形式，结合上面<u><em>复杂且多样的cell的处理</em></u>让开发业务起来更加简单，毕竟客户端大部分的时间都是在写ui。可以更好的把ui剥离开，从而在逻辑上以及交互上更加纯粹以及简单，从而bug也会更少</li>
<li><strong><em>结构的分层</em></strong>  尽可能的进行结构分层，该是vc就是vc，该是view就是view,数据层就是数据层，网络层就是网络层，以及埋点，路由等等，并且让每个结构尽可能纯粹只做属于自身的事情，这是mvc很基础的理念了</li>
<li><strong><em>统一的代码风格</em></strong>  确定统一的风格，利用模版生成一些胶水代码，很方便后续的维护以及多人参与</li>
<li><strong><em>快捷简便的多人开发</em></strong>  通过上诉这些处理加上一些文档以及分享，来统一意识。多人可以用同样的思想来思考首页的迭代，更加方便多人开发。让每个人知道如果首页出了问题应该去哪个模块的哪个层的哪个文件的哪个函数去查。同样增加业务删除业务也是</li>
</ul>
<h4 id="实现的主题技术框架"><a href="#实现的主题技术框架" class="headerlink" title="实现的主题技术框架"></a>实现的主题技术框架</h4><p> 不怎么想去讨论mvc以及mvvm的孰优孰劣。本来不同的业务就该用不同的架构，为了架构而去架构是一件很没有必要的事情，所有的技术都是为业务负责。对我个人而言就是简单的稳定的业务我会用mvc。而繁重的快速迭代的业务用mvvm。很显然首页是典型的后者</p>
<p>另外我会考虑使用 <a href="https://en.wikipedia.org/wiki/Functional_reactive_programming" target="_blank" rel="noopener">FRP</a>中OC的框架<a href="https://github.com/ReactiveCocoa/ReactiveObjC" target="_blank" rel="noopener">RAC</a>,<a href="https://en.wikipedia.org/wiki/Functional_reactive_programming" target="_blank" rel="noopener">FRP</a>是一个学习难度很陡峭的思想，但是非常好用。尽管他有一些缺陷，但是在我需要面向模型开发这种思想的时候非常好用，让我不用任何数据变动都进行整个页面的reload，并且可以更加放大mvvm的功效，在我构思好整个页面的”input” + “output”的时候mvvm+FRP能起到更好的效果，这点会在下面进行更好的体现</p>
<p>我还会考虑去使用<a href="https://github.com/Instagram/IGListKit" target="_blank" rel="noopener">IGListKit</a>, 作为一个instagram出品的一个关于collectionview的框架，他有太多的优点。例如文档中所说</p>
<blockquote>
<ol>
<li>无须直接调用 <code>performBatchUpdates(_:, completion:)</code> 或 <code>reloadData()</code></li>
<li>更好的可复用 cell 和组件体系结构</li>
<li>创建具有多个数据类型的列表</li>
<li>解耦的 Diff 算法</li>
<li>完全的单元测试</li>
<li>可自定义数据模型的 Diff 行为</li>
<li>简化并维持<code>UICollectionView</code>的核心特性</li>
<li>可扩展的 API 设计</li>
<li>Objective-C 编写,同时完全支持 Swift</li>
</ol>
</blockquote>
<p>但是对我而言，最重要的是1 2 6 7这几点。在以往开发中我们collectionview的单行增删改的过程中如果对数据以及视图没有做好对应很容易产生崩溃。而IGListKit的diff可以避免这个问题。并且IGList可以更加发挥我面向数据开发以及多个数据类型的cell的需求。而且在开发中虽然我们尽量保持cell作为一个view的展示属性的纯粹。但是在业务开发中cell的一些页面的交互和跳转是不可避免的，我们当然可以通过回调或者代码一层层回调出来。然后IGList的这种sectionController可以完美解决这种问题。这种view和控制器的剥离方式实在是太赞了</p>
<h4 id="大概的蓝图构思"><a href="#大概的蓝图构思" class="headerlink" title="大概的蓝图构思"></a>大概的蓝图构思</h4><p><img src="/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%841.png" alt="首页重构"></p>
<p>我大概理想中的首页重构是这样的，从控制器说起</p>
<h6 id="VC中的几大模块"><a href="#VC中的几大模块" class="headerlink" title="VC中的几大模块:"></a>VC中的几大模块:</h6><ul>
<li><strong><em>View :</em></strong> 呈现的内容，像我们首页中大的主体是一个collectionview，以及几个其他整合封装好的其他的view，例如悬浮窗啊等等..</li>
<li><strong><em>ViewModel :</em></strong>  mvvm中核心的vm层，搭配RAC把ViewModel做成一个管道，有注入口和出水口，这个想法比较抽象，首先说出水口就是图中对应解析好一个个cellModel组成的groupModel给控制器直接解析给collectionview使用，对应的就是之前IGListKit的一个sectionController然后。而Input就是指的是一切会改变页面显示样式的操作。例如页面的加载，页面的下拉刷新，上啦加载更多，甚至用户点击了一个按钮页面上要做对应的增删改都可以理解为InPut。然后viewModel就是把这些Input 进行map，变成本地的或者从新进行网络请求的数据，然后生成对应的新的cellmodel。然后发送output信号，从而订阅了output信号的视图进行更新。所以 把viewmodel抽象成管道的理解就可以非常容易了</li>
<li><strong><em>Tool层:</em></strong>  包含了一些工具类，例如我们首页有截屏分享的功能,还有一些功能都可以抽成工具类。另外还有很重要的用户响应层，这里面处理了页面上所有用户的点击的回调分发，例如跳转到商详页面。其中响应层又包含了埋点层和路由层，因为对大多数客户端的点击来说，一个点击基本都是跳转到一个页面。而我们业务之前在做组件化的时候就已经把所有的跳转路由化了。所以路由层承接的是跳转的功能，而埋点层则承接的是埋点</li>
<li><strong><em>NetWork层：</em></strong> 属于viewmodel的附属，包含了当前业务模块的所有网路请求，提供了一系列的请求方法来请求不同模块的数据。起的作用是整合所有网络层，请求参数以及把json解析成model给ViewModel层的作用</li>
</ul>
<h4 id="大概的实施步骤"><a href="#大概的实施步骤" class="headerlink" title="大概的实施步骤"></a>大概的实施步骤</h4><p>方案定下来了之后就是大概的实施，但是由于重构首页这么大的模块肯定有很大的工作量和风险。所以在争取资源和规避风险要做到一些努力。在规避风险上我们是按照具体的顺序来重构，让每个版本上线的模块尽可能的小。把风险分散化</p>
<ul>
<li><strong><em>开会说方案，以及拉后台和测试争取资源。例如让后台整合接口以及处理数据，承接以前客户端处理数据的功能，同时解放安卓和h5。争取测试资源，分批测试重构的内容，首页重中之中，确保万无一失去。</em></strong></li>
<li><strong><em>提前准备好ab方案，每次的重构内容都有开关，如果真的线上有问题进行开关关闭，稳定上线2个版本撤销对应的开关</em></strong></li>
<li><strong><em>按照好顺序来分期重构业务，分散风险以及和测试和开发预留时间。例如我们1期先上一些边边角角的视图，对整体的代码模块变动并不大。二期把网络层整合出来，也不用更改一些控制器的代码，只是把代码进行整合和优化。三期就把之前的cell变动成我们上面所说的模式的cell…..等等按照节奏一步步的来处理，让测试有节奏的把握风险</em></strong></li>
<li><strong><em>删除无用的代码，这点也很重要，因为删除了无用代码可以让后来的人在查找业务方便很多，也可以提高少量的编译速度以及降低包体积</em></strong></li>
<li><strong><em>整体完成上线之后在组内进行多次分享和宣讲，推广到其他业务。让所有人都懂这个模式并且按照这个模式开发</em></strong></li>
</ul>
<h4 id="一些样板代码"><a href="#一些样板代码" class="headerlink" title="一些样板代码"></a>一些样板代码</h4><p>在上面我们有说我们把所有的cell提供统一的接口来充实自己的内容，同样我们给所有的模型也提供一些cell要用的通用属性。其实很简单，大概的代码就长成这个样子</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BaseCellModel</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 原始数据的实例对象 */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>) <span class="keyword">id</span> entity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*! identifier */</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *cellIdentifier;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"> *  @brief 子类复写create。从而延迟创建cellModel的内容。也可以重写初始化方法，创建cellModel的内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithEntity:(<span class="keyword">id</span>)entity <span class="built_in">NS_REQUIRES_SUPER</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 子类重写返回对应的identifier</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)configCellIdentifier;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)create <span class="built_in">NS_REQUIRES_SUPER</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BaseColViewCellModel</span> : <span class="title">BaseCellModel</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*! itemeSize */</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">CGSize</span> itemSize;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 子类重写返回对应的itemSize</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">CGSize</span> )configItemSize;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>因为相当于的BaseColViewCellModel还有一个对应的tableviewCell的版本，所有通用的都封装在BaseCellModel里，接口中提供一个接受id类型的数据，就是服务器的原始数据。然后子类调用对应的create方法并且在内部实现成视图需要的数据，例如一大串的富文本。保证cell可以直接用cellmodel的成员变量。 而cellIdentifier就是给数据源来初始化对应的cell使用的。内部统一的实现就是,结果就是自己的类型去除掉model几个字，就是cell的类名。当然如果有特殊的情况可以子类重写。同样configItemSize就是子类来实现自己大小的函数，执行一次之后会赋值给itemsize，起到缓存和降低cpu资源消耗的作用</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSString</span> *)configCellIdentifier</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *str = <span class="built_in">NSStringFromClass</span>(<span class="keyword">self</span>.class);</span><br><span class="line">    <span class="keyword">return</span>   [str substringToIndex:str.length - <span class="number">5</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而cell就长成这个样子</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BaseCollectionViewCell</span>&lt;<span class="title">T</span>: <span class="title">BaseColViewCellModel</span> *&gt; : <span class="title">UICollectionViewCell</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据对象</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) T entity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 根据数据配置视图</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param entity 数据对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)configureWithEntity:(T)entity <span class="built_in">NS_REQUIRES_SUPER</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  自动返回cell的identifierId格式为【xib名称】</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @return 格式为【xib名称/ 类名】(如：XXXViewCell)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSString</span>*)getCollectionViewCellIdentifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">- (<span class="keyword">void</span>)configureWithEntity:(<span class="keyword">id</span>)entity</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.entity = entity;</span><br><span class="line">    <span class="comment">// bind data -&gt; view, by subclass...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSString</span> *)getCollectionViewCellIdentifier</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">NSStringFromClass</span>(<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>configureWithEntity就是把cellmodel展示在自己内部视图的实现，getCollectionViewCellIdentifier就直接返回的是自己的类名，恰好和对应cellmodel的对象方法成了一一对应，其实这个类方法是用给注册cell的。避免软编码。另外我会在这一层再进行一层业务层的封装。类似这样</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^HomeInteractionClosure)(<span class="keyword">id</span> _Nullable obj,HomeInteractionType type, <span class="keyword">id</span> _Nullable additionObj);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">HomeBaseCollectionViewCell</span> : <span class="title">BaseCollectionViewCell</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*! 点击回调 */</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) HomeInteractionClosure interactionClosure;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>方便统一处理回调给vc的interactionTool，其实做完这些胶水代码之后首页对cell的处理大概就是这个样式的</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HomeBaseCellModel *model = <span class="keyword">self</span>.sectionModels[indexPath.section].colCellModels[indexPath.row];</span><br><span class="line"></span><br><span class="line">BaseCollectionCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:model.cellIdentifier forIndexPath:indexPath];</span><br><span class="line">[cell configureWithEntity:model];</span><br><span class="line"></span><br><span class="line">@weakify(<span class="keyword">self</span>)</span><br><span class="line">cell.interactionClosure = ^(<span class="keyword">id</span>  _Nullable obj, YJPopInteractionType type, <span class="keyword">id</span>  _Nullable additionObj) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在viewmodel层内部请求到数据之后，viewModel会根据不同类型的服务器数据生成对应的cellModel然后统一抛给控制器，然后通过统一的成员变量拿到不同的identifier来生成不同的cell。然后调用统一的填充接口让具体的真实类型负责自己内部的处理</p>
<h4 id="一些成果和缺点"><a href="#一些成果和缺点" class="headerlink" title="一些成果和缺点"></a>一些成果和缺点</h4><p>在耗时接近半年之后，项目完美交付。取得了很多成果但是也有一些弊端，先拿弊端来说</p>
<h6 id="弊端"><a href="#弊端" class="headerlink" title="弊端"></a>弊端</h6><ul>
<li><p><strong><em>学习成本有点陡峭</em></strong>  因为这套东西利用了frp的思想以及大量的面相对象的知识，面相对象倒还好，但是对于客户端开发来说以往的编码习惯都是，所有的view都通过数据填充，用户点了按钮外抛出去，更新数据，然后调用视图的对应的更新方法来更新视图。所有frp这套思维很颠覆以往的习惯。更不谈input和output这种高度抽象，把用户行为抽象成响应流的操作了。所以我们后期都是开展大量的分享来帮大家一起提高。因为这么做不仅简化了代码，也简化了思维，在一个业务在下之后想好了所有的出入口。可以极大的降低bug率。并且这种方式也更适合后续的SwiftUI这种声明式UI+FRP的开发方式。我觉得不仅是iOS，整个客户端甚至大前端的大概方向都是如此</p>
</li>
<li><p><strong><em>会需要写少量的胶水代码</em></strong>  模块的拆分不可避免的需要面对这个问题，像上面的那些都属于胶水代码，我们对这里处理方式是做成对应的模版，让开发直接使用模版来操作。例如下图我们只需要点击第一个按钮，然后输入对应的模块名，以及注释。我们就会生成对应的cell和cellModel2个类的.h.m文件。cell中的代码大概是这样的。这么做就可以避免写胶水代码的同时还统一了团队的代码风格，对应的工程师只需要按图索骥，在对应的函数里进行填鸭就行了</p>
</li>
</ul>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - <span class="meta-string">&lt;lifeCycle&gt;</span></span></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame]) &#123;</span><br><span class="line">        [<span class="keyword">self</span> setupUI];</span><br><span class="line">        [<span class="keyword">self</span> makeConstraints];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupUI</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// do setup ui code, plz make sure all subviews are added to contentView, not cell</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)makeConstraints</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// do constraints code</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configureWithEntity:(SubjectCardCellModel *)entity &#123;</span><br><span class="line">    [<span class="keyword">super</span> configureWithEntity:entity];</span><br><span class="line">    <span class="keyword">if</span> (![entity isKindOfClass:SubjectCardCellModel.class]) &#123; <span class="keyword">return</span>; &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - <span class="meta-string">&lt;userInterfaction&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>  ​    而cellModel中的大概是这样的</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)create &#123;</span><br><span class="line">    [<span class="keyword">super</span> create];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// safe check</span></span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.entity isKindOfClass:&lt;#ClassType#&gt;.class]) &#123; <span class="keyword">return</span>; &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// model -&gt; cellModel</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGSize</span>)configItemSize</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">CGSizeZero</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%842.png" alt="首页重构"></p>
<p><img src="/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%843.png" alt="首页重构"></p>
<h6 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h6><ul>
<li><strong><em>极大降低了迭代难度</em></strong>  <strong><em>:</em></strong> 经过重构之后，各个模块结构清晰。例如需要在首页新增一个模块，就只需要用模版新建一个模块，再内部写对应的视图和转化数据。然后再viewModel中把后台新给的数据转化成对应的cellModel类型就好。 再说删除，如果需要删除某一个模块，只需要在viewModel中把对应模块的解析注释掉就行了。对于改动和查找代码也很简单，例如页面的尺寸或者展示有问题，就去cell中，如果展示出来的数据有问题，就看服务器数据以及自己cellModel中的 转换是否有问题，埋点则去埋点层。交互就去交互层，非常简单</li>
<li><strong><em>极大的方便了多人开发</em></strong> <strong><em>:</em></strong> 从上面就可以看到，由于统一了范式以及功能模块化之后，看代码非常简单，甚至可以把一个新业务的细粒度拆到令人发指。甚至可以一个人去专门写ui，一个人写解析</li>
<li><strong><em>大大降低了bug率:</em></strong> 通过这种方式后更加方便了单元测试，而且编程的思想也进行了对应的改变，一个业务下来了之后，大家都会想好这个业务的出入口。哪些用户的操作会引起业务的改变。除去机械化的ui代码以外，可以更加集中精力在逻辑代码上。像我们无论是同比还是环比，组内的bug率普遍下降了40%</li>
<li><strong><em>极大的提高了开发效率</em></strong>： 直接通过我们的效能平台，光我们iOS的交付效率比以往高了30%还多</li>
<li><strong><em>让开发更加轻松又更加会思考:</em></strong>  经过这次重构之后，普遍组内的人对业务会进行更加深度的思考，也会积极的去和外部部门pk，例如后台和测试。更加有利于团队的竞争和成长</li>
</ul>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>青禾
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://qingheblog.online/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E9%A6%96%E9%A1%B5%E9%87%8D%E6%9E%84/" title="首页重构">http://qingheblog.online/工作总结/首页重构/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/jenkins%E9%95%9C%E5%83%8F%E6%9B%B4%E6%96%B0/" rel="prev" title="jenkins镜像更新">
      <i class="fa fa-chevron-left"></i> jenkins镜像更新
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#现存的问题"><span class="nav-number">2.</span> <span class="nav-text">现存的问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#想达到的效果"><span class="nav-number">3.</span> <span class="nav-text">想达到的效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实现的主题技术框架"><span class="nav-number">4.</span> <span class="nav-text">实现的主题技术框架</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大概的蓝图构思"><span class="nav-number">5.</span> <span class="nav-text">大概的蓝图构思</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#VC中的几大模块"><span class="nav-number">5.0.1.</span> <span class="nav-text">VC中的几大模块:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大概的实施步骤"><span class="nav-number">6.</span> <span class="nav-text">大概的实施步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一些样板代码"><span class="nav-number">7.</span> <span class="nav-text">一些样板代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一些成果和缺点"><span class="nav-number">8.</span> <span class="nav-text">一些成果和缺点</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#弊端"><span class="nav-number">8.0.1.</span> <span class="nav-text">弊端</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#成果"><span class="nav-number">8.0.2.</span> <span class="nav-text">成果</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="青禾"
      src="/images/avatar.JPG">
  <p class="site-author-name" itemprop="name">青禾</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/YaoJuan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;YaoJuan" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/xx8611205@gmail.com" title="E-Mail → xx8611205@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">青禾</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>


  















  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'd8d3c3e7eb485c5898d7',
      clientSecret: '21a1bb2602f0d5a3e849a524cbe4900632c995c1',
      repo        : 'YaoJuan.github.io',
      owner       : 'YaoJuan',
      admin       : ['YaoJuan'],
      id          : 'cfcb660022d423030e58b6fe3e7365dc',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tsumiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
